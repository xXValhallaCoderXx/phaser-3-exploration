{"ast":null,"code":"import Phaser from \"phaser\";\nimport Player from \"./Player\";\n\nclass PlayerContainer extends Phaser.GameObjects.Container {\n  constructor(scene, x, y, key, frame, health, maxHealth, id, attackAudio, mainPlayer) {\n    super(scene, x, y); //store a reference to the scene\n\n    this.scene = scene;\n    this.velocity = 160;\n    this.currentDirection = DIRECTION.RIGHT;\n    this.playerAttacking = false;\n    this.flipX = true;\n    this.swordHit = false;\n    this.health = health;\n    this.maxHealth = maxHealth;\n    this.id = id;\n    this.attackAudio = attackAudio;\n    this.mainPlayer = mainPlayer; // set size on container\n    // by default container wont have size till objs added\n\n    this.setSize(64, 64); // enable physics\n\n    this.scene.physics.world.enable(this); // collide with world bounds\n\n    this.body.setCollideWorldBounds(true); // add the player to our existing scene\n\n    this.scene.add.existing(this);\n\n    if (this.mainPlayer) {\n      this.scene.cameras.main.startFollow(this);\n    } // create player\n    // Game object is relative to container\n\n\n    this.player = new Player(this.scene, 0, 0, key, frame);\n    this.add(this.player); // Create weapon\n\n    this.weapon = this.scene.add.image(40, 0, \"items\", 4);\n    this.weapon.setScale(1.5);\n    this.scene.physics.world.enable(this.weapon);\n    this.add(this.weapon);\n    this.weapon.alpha = 0; // Want weapon to show only when swinging\n\n    this.createHealthBar();\n  }\n\n  updateHealth(health) {\n    this.health = health;\n    this.updateHealthBar();\n  }\n\n  createHealthBar() {\n    this.healthBar = this.scene.add.graphics();\n    this.updateHealthBar();\n  }\n\n  updateHealthBar() {\n    this.healthBar.clear();\n    this.healthBar.fillStyle(0xffffff, 1);\n    this.healthBar.fillRect(this.x - 32, this.y - 40, 64, 5);\n    this.healthBar.fillGradientStyle(0xff0000, 0xffffff, 4);\n    this.healthBar.fillRect(this.x - 32, this.y - 40, 64 * (this.health / this.maxHealth), 5);\n  }\n\n  respawn(player) {\n    this.health = player.health;\n    this.setPosition(player.x, player.y);\n    this.updateHealthBar();\n  }\n\n  update(cursors) {\n    this.body.setVelocity(0);\n\n    if (this.mainPlayer) {\n      if (cursors.left.isDown) {\n        this.body.setVelocityX(-this.velocity);\n        this.currentDirection = DIRECTION.LEFT;\n        this.player.flipX = false;\n      } else if (cursors.right.isDown) {\n        this.body.setVelocityX(this.velocity);\n        this.currentDirection = DIRECTION.RIGHT;\n        this.player.flipX = true;\n      }\n\n      if (cursors.up.isDown) {\n        this.body.setVelocityY(-this.velocity);\n        this.currentDirection = DIRECTION.UP;\n      } else if (cursors.down.isDown) {\n        this.body.setVelocityY(this.velocity);\n        this.currentDirection = DIRECTION.DOWN;\n      }\n\n      if (Phaser.Input.Keyboard.JustDown(cursors.space) && !this.playerAttacking) {\n        this.attack();\n      }\n    }\n\n    if (this.currentDirection === DIRECTION.UP) {\n      this.weapon.setPosition(0, -40);\n    } else if (this.currentDirection === DIRECTION.DOWN) {\n      this.weapon.setPosition(0, 40);\n    } else if (this.currentDirection === DIRECTION.LEFT) {\n      this.weapon.setPosition(-40, 0);\n    } else if (this.currentDirection === DIRECTION.RIGHT) {\n      this.weapon.setPosition(40, 0);\n    }\n\n    if (this.playerAttacking) {\n      if (this.weapon.flipX) {\n        this.weapon.angle -= 10;\n      } else {\n        this.weapon.angle += 10;\n      }\n    } else {\n      if (this.currentDirection === DIRECTION.DOWN) {\n        this.weapon.setAngle(-270);\n      } else if (this.currentDirection === DIRECTION.UP) {\n        this.weapon.setAngle(-90);\n      } else {\n        this.weapon.setAngle(0);\n      }\n    }\n\n    this.weapon.flipX = false;\n\n    if (this.currentDirection === DIRECTION.LEFT) {\n      this.weapon.flipX = true;\n    }\n\n    this.updateHealthBar();\n  }\n\n  updateFlipX() {\n    this.player.flipX = this.flipX;\n  }\n\n  attack() {\n    this.attackAudio.play();\n    this.weapon.alpha = 1;\n    this.playerAttacking = true;\n    this.scene.time.delayedCall(150, () => {\n      this.weapon.alpha = 0;\n      this.playerAttacking = false;\n      this.swordHit = false;\n    }, [], this);\n  }\n\n}\n\nconst DIRECTION = {\n  RIGHT: \"RIGHT\",\n  LEFT: \"LEFT\",\n  UP: \"UP\",\n  DOWN: \"DOWN\"\n};\nexport default PlayerContainer;","map":{"version":3,"sources":["/home/odin/Dungeon/Github/phaser-3-exploration/client/src/game-core/classes/player/PlayerContainer.js"],"names":["Phaser","Player","PlayerContainer","GameObjects","Container","constructor","scene","x","y","key","frame","health","maxHealth","id","attackAudio","mainPlayer","velocity","currentDirection","DIRECTION","RIGHT","playerAttacking","flipX","swordHit","setSize","physics","world","enable","body","setCollideWorldBounds","add","existing","cameras","main","startFollow","player","weapon","image","setScale","alpha","createHealthBar","updateHealth","updateHealthBar","healthBar","graphics","clear","fillStyle","fillRect","fillGradientStyle","respawn","setPosition","update","cursors","setVelocity","left","isDown","setVelocityX","LEFT","right","up","setVelocityY","UP","down","DOWN","Input","Keyboard","JustDown","space","attack","angle","setAngle","updateFlipX","play","time","delayedCall"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,QAAnB;AACA,OAAOC,MAAP,MAAmB,UAAnB;;AACA,MAAMC,eAAN,SAA8BF,MAAM,CAACG,WAAP,CAAmBC,SAAjD,CAA2D;AACzDC,EAAAA,WAAW,CACTC,KADS,EAETC,CAFS,EAGTC,CAHS,EAITC,GAJS,EAKTC,KALS,EAMTC,MANS,EAOTC,SAPS,EAQTC,EARS,EASTC,WATS,EAUTC,UAVS,EAWT;AACA,UAAMT,KAAN,EAAaC,CAAb,EAAgBC,CAAhB,EADA,CAGA;;AACA,SAAKF,KAAL,GAAaA,KAAb;AACA,SAAKU,QAAL,GAAgB,GAAhB;AACA,SAAKC,gBAAL,GAAwBC,SAAS,CAACC,KAAlC;AACA,SAAKC,eAAL,GAAuB,KAAvB;AACA,SAAKC,KAAL,GAAa,IAAb;AACA,SAAKC,QAAL,GAAgB,KAAhB;AACA,SAAKX,MAAL,GAAcA,MAAd;AACA,SAAKC,SAAL,GAAiBA,SAAjB;AACA,SAAKC,EAAL,GAAUA,EAAV;AACA,SAAKC,WAAL,GAAmBA,WAAnB;AACA,SAAKC,UAAL,GAAkBA,UAAlB,CAdA,CAeA;AACA;;AACA,SAAKQ,OAAL,CAAa,EAAb,EAAiB,EAAjB,EAjBA,CAmBA;;AACA,SAAKjB,KAAL,CAAWkB,OAAX,CAAmBC,KAAnB,CAAyBC,MAAzB,CAAgC,IAAhC,EApBA,CAsBA;;AACA,SAAKC,IAAL,CAAUC,qBAAV,CAAgC,IAAhC,EAvBA,CAwBA;;AACA,SAAKtB,KAAL,CAAWuB,GAAX,CAAeC,QAAf,CAAwB,IAAxB;;AAEA,QAAI,KAAKf,UAAT,EAAqB;AACnB,WAAKT,KAAL,CAAWyB,OAAX,CAAmBC,IAAnB,CAAwBC,WAAxB,CAAoC,IAApC;AACD,KA7BD,CA+BA;AACA;;;AACA,SAAKC,MAAL,GAAc,IAAIjC,MAAJ,CAAW,KAAKK,KAAhB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6BG,GAA7B,EAAkCC,KAAlC,CAAd;AACA,SAAKmB,GAAL,CAAS,KAAKK,MAAd,EAlCA,CAoCA;;AACA,SAAKC,MAAL,GAAc,KAAK7B,KAAL,CAAWuB,GAAX,CAAeO,KAAf,CAAqB,EAArB,EAAyB,CAAzB,EAA4B,OAA5B,EAAqC,CAArC,CAAd;AACA,SAAKD,MAAL,CAAYE,QAAZ,CAAqB,GAArB;AACA,SAAK/B,KAAL,CAAWkB,OAAX,CAAmBC,KAAnB,CAAyBC,MAAzB,CAAgC,KAAKS,MAArC;AACA,SAAKN,GAAL,CAAS,KAAKM,MAAd;AACA,SAAKA,MAAL,CAAYG,KAAZ,GAAoB,CAApB,CAzCA,CAyCuB;;AAEvB,SAAKC,eAAL;AACD;;AAEDC,EAAAA,YAAY,CAAC7B,MAAD,EAAS;AACnB,SAAKA,MAAL,GAAcA,MAAd;AACA,SAAK8B,eAAL;AACD;;AAEDF,EAAAA,eAAe,GAAG;AAChB,SAAKG,SAAL,GAAiB,KAAKpC,KAAL,CAAWuB,GAAX,CAAec,QAAf,EAAjB;AACA,SAAKF,eAAL;AACD;;AAEDA,EAAAA,eAAe,GAAG;AAChB,SAAKC,SAAL,CAAeE,KAAf;AACA,SAAKF,SAAL,CAAeG,SAAf,CAAyB,QAAzB,EAAmC,CAAnC;AACA,SAAKH,SAAL,CAAeI,QAAf,CAAwB,KAAKvC,CAAL,GAAS,EAAjC,EAAqC,KAAKC,CAAL,GAAS,EAA9C,EAAkD,EAAlD,EAAsD,CAAtD;AACA,SAAKkC,SAAL,CAAeK,iBAAf,CAAiC,QAAjC,EAA2C,QAA3C,EAAqD,CAArD;AACA,SAAKL,SAAL,CAAeI,QAAf,CACE,KAAKvC,CAAL,GAAS,EADX,EAEE,KAAKC,CAAL,GAAS,EAFX,EAGE,MAAM,KAAKG,MAAL,GAAc,KAAKC,SAAzB,CAHF,EAIE,CAJF;AAMD;;AAEDoC,EAAAA,OAAO,CAACd,MAAD,EAAS;AACd,SAAKvB,MAAL,GAAcuB,MAAM,CAACvB,MAArB;AACA,SAAKsC,WAAL,CAAiBf,MAAM,CAAC3B,CAAxB,EAA2B2B,MAAM,CAAC1B,CAAlC;AACA,SAAKiC,eAAL;AACD;;AAEDS,EAAAA,MAAM,CAACC,OAAD,EAAU;AACd,SAAKxB,IAAL,CAAUyB,WAAV,CAAsB,CAAtB;;AAEA,QAAI,KAAKrC,UAAT,EAAqB;AACnB,UAAIoC,OAAO,CAACE,IAAR,CAAaC,MAAjB,EAAyB;AACvB,aAAK3B,IAAL,CAAU4B,YAAV,CAAuB,CAAC,KAAKvC,QAA7B;AACA,aAAKC,gBAAL,GAAwBC,SAAS,CAACsC,IAAlC;AAEA,aAAKtB,MAAL,CAAYb,KAAZ,GAAoB,KAApB;AACD,OALD,MAKO,IAAI8B,OAAO,CAACM,KAAR,CAAcH,MAAlB,EAA0B;AAC/B,aAAK3B,IAAL,CAAU4B,YAAV,CAAuB,KAAKvC,QAA5B;AACA,aAAKC,gBAAL,GAAwBC,SAAS,CAACC,KAAlC;AAEA,aAAKe,MAAL,CAAYb,KAAZ,GAAoB,IAApB;AACD;;AAED,UAAI8B,OAAO,CAACO,EAAR,CAAWJ,MAAf,EAAuB;AACrB,aAAK3B,IAAL,CAAUgC,YAAV,CAAuB,CAAC,KAAK3C,QAA7B;AACA,aAAKC,gBAAL,GAAwBC,SAAS,CAAC0C,EAAlC;AACD,OAHD,MAGO,IAAIT,OAAO,CAACU,IAAR,CAAaP,MAAjB,EAAyB;AAC9B,aAAK3B,IAAL,CAAUgC,YAAV,CAAuB,KAAK3C,QAA5B;AAEA,aAAKC,gBAAL,GAAwBC,SAAS,CAAC4C,IAAlC;AACD;;AAED,UACE9D,MAAM,CAAC+D,KAAP,CAAaC,QAAb,CAAsBC,QAAtB,CAA+Bd,OAAO,CAACe,KAAvC,KACA,CAAC,KAAK9C,eAFR,EAGE;AACA,aAAK+C,MAAL;AACD;AACF;;AACD,QAAI,KAAKlD,gBAAL,KAA0BC,SAAS,CAAC0C,EAAxC,EAA4C;AAC1C,WAAKzB,MAAL,CAAYc,WAAZ,CAAwB,CAAxB,EAA2B,CAAC,EAA5B;AACD,KAFD,MAEO,IAAI,KAAKhC,gBAAL,KAA0BC,SAAS,CAAC4C,IAAxC,EAA8C;AACnD,WAAK3B,MAAL,CAAYc,WAAZ,CAAwB,CAAxB,EAA2B,EAA3B;AACD,KAFM,MAEA,IAAI,KAAKhC,gBAAL,KAA0BC,SAAS,CAACsC,IAAxC,EAA8C;AACnD,WAAKrB,MAAL,CAAYc,WAAZ,CAAwB,CAAC,EAAzB,EAA6B,CAA7B;AACD,KAFM,MAEA,IAAI,KAAKhC,gBAAL,KAA0BC,SAAS,CAACC,KAAxC,EAA+C;AACpD,WAAKgB,MAAL,CAAYc,WAAZ,CAAwB,EAAxB,EAA4B,CAA5B;AACD;;AACD,QAAI,KAAK7B,eAAT,EAA0B;AACxB,UAAI,KAAKe,MAAL,CAAYd,KAAhB,EAAuB;AACrB,aAAKc,MAAL,CAAYiC,KAAZ,IAAqB,EAArB;AACD,OAFD,MAEO;AACL,aAAKjC,MAAL,CAAYiC,KAAZ,IAAqB,EAArB;AACD;AACF,KAND,MAMO;AACL,UAAI,KAAKnD,gBAAL,KAA0BC,SAAS,CAAC4C,IAAxC,EAA8C;AAC5C,aAAK3B,MAAL,CAAYkC,QAAZ,CAAqB,CAAC,GAAtB;AACD,OAFD,MAEO,IAAI,KAAKpD,gBAAL,KAA0BC,SAAS,CAAC0C,EAAxC,EAA4C;AACjD,aAAKzB,MAAL,CAAYkC,QAAZ,CAAqB,CAAC,EAAtB;AACD,OAFM,MAEA;AACL,aAAKlC,MAAL,CAAYkC,QAAZ,CAAqB,CAArB;AACD;AACF;;AAED,SAAKlC,MAAL,CAAYd,KAAZ,GAAoB,KAApB;;AACA,QAAI,KAAKJ,gBAAL,KAA0BC,SAAS,CAACsC,IAAxC,EAA8C;AAC5C,WAAKrB,MAAL,CAAYd,KAAZ,GAAoB,IAApB;AACD;;AAED,SAAKoB,eAAL;AACD;;AAED6B,EAAAA,WAAW,GAAG;AACZ,SAAKpC,MAAL,CAAYb,KAAZ,GAAoB,KAAKA,KAAzB;AACD;;AAED8C,EAAAA,MAAM,GAAG;AACP,SAAKrD,WAAL,CAAiByD,IAAjB;AACA,SAAKpC,MAAL,CAAYG,KAAZ,GAAoB,CAApB;AACA,SAAKlB,eAAL,GAAuB,IAAvB;AACA,SAAKd,KAAL,CAAWkE,IAAX,CAAgBC,WAAhB,CACE,GADF,EAEE,MAAM;AACJ,WAAKtC,MAAL,CAAYG,KAAZ,GAAoB,CAApB;AACA,WAAKlB,eAAL,GAAuB,KAAvB;AACA,WAAKE,QAAL,GAAgB,KAAhB;AACD,KANH,EAOE,EAPF,EAQE,IARF;AAUD;;AA1KwD;;AA6K3D,MAAMJ,SAAS,GAAG;AAChBC,EAAAA,KAAK,EAAE,OADS;AAEhBqC,EAAAA,IAAI,EAAE,MAFU;AAGhBI,EAAAA,EAAE,EAAE,IAHY;AAIhBE,EAAAA,IAAI,EAAE;AAJU,CAAlB;AAOA,eAAe5D,eAAf","sourcesContent":["import Phaser from \"phaser\";\nimport Player from \"./Player\";\nclass PlayerContainer extends Phaser.GameObjects.Container {\n  constructor(\n    scene,\n    x,\n    y,\n    key,\n    frame,\n    health,\n    maxHealth,\n    id,\n    attackAudio,\n    mainPlayer\n  ) {\n    super(scene, x, y);\n\n    //store a reference to the scene\n    this.scene = scene;\n    this.velocity = 160;\n    this.currentDirection = DIRECTION.RIGHT;\n    this.playerAttacking = false;\n    this.flipX = true;\n    this.swordHit = false;\n    this.health = health;\n    this.maxHealth = maxHealth;\n    this.id = id;\n    this.attackAudio = attackAudio;\n    this.mainPlayer = mainPlayer;\n    // set size on container\n    // by default container wont have size till objs added\n    this.setSize(64, 64);\n\n    // enable physics\n    this.scene.physics.world.enable(this);\n\n    // collide with world bounds\n    this.body.setCollideWorldBounds(true);\n    // add the player to our existing scene\n    this.scene.add.existing(this);\n\n    if (this.mainPlayer) {\n      this.scene.cameras.main.startFollow(this);\n    }\n\n    // create player\n    // Game object is relative to container\n    this.player = new Player(this.scene, 0, 0, key, frame);\n    this.add(this.player);\n\n    // Create weapon\n    this.weapon = this.scene.add.image(40, 0, \"items\", 4);\n    this.weapon.setScale(1.5);\n    this.scene.physics.world.enable(this.weapon);\n    this.add(this.weapon);\n    this.weapon.alpha = 0; // Want weapon to show only when swinging\n\n    this.createHealthBar();\n  }\n\n  updateHealth(health) {\n    this.health = health;\n    this.updateHealthBar();\n  }\n\n  createHealthBar() {\n    this.healthBar = this.scene.add.graphics();\n    this.updateHealthBar();\n  }\n\n  updateHealthBar() {\n    this.healthBar.clear();\n    this.healthBar.fillStyle(0xffffff, 1);\n    this.healthBar.fillRect(this.x - 32, this.y - 40, 64, 5);\n    this.healthBar.fillGradientStyle(0xff0000, 0xffffff, 4);\n    this.healthBar.fillRect(\n      this.x - 32,\n      this.y - 40,\n      64 * (this.health / this.maxHealth),\n      5\n    );\n  }\n\n  respawn(player) {\n    this.health = player.health;\n    this.setPosition(player.x, player.y);\n    this.updateHealthBar();\n  }\n\n  update(cursors) {\n    this.body.setVelocity(0);\n\n    if (this.mainPlayer) {\n      if (cursors.left.isDown) {\n        this.body.setVelocityX(-this.velocity);\n        this.currentDirection = DIRECTION.LEFT;\n\n        this.player.flipX = false;\n      } else if (cursors.right.isDown) {\n        this.body.setVelocityX(this.velocity);\n        this.currentDirection = DIRECTION.RIGHT;\n\n        this.player.flipX = true;\n      }\n\n      if (cursors.up.isDown) {\n        this.body.setVelocityY(-this.velocity);\n        this.currentDirection = DIRECTION.UP;\n      } else if (cursors.down.isDown) {\n        this.body.setVelocityY(this.velocity);\n\n        this.currentDirection = DIRECTION.DOWN;\n      }\n\n      if (\n        Phaser.Input.Keyboard.JustDown(cursors.space) &&\n        !this.playerAttacking\n      ) {\n        this.attack();\n      }\n    }\n    if (this.currentDirection === DIRECTION.UP) {\n      this.weapon.setPosition(0, -40);\n    } else if (this.currentDirection === DIRECTION.DOWN) {\n      this.weapon.setPosition(0, 40);\n    } else if (this.currentDirection === DIRECTION.LEFT) {\n      this.weapon.setPosition(-40, 0);\n    } else if (this.currentDirection === DIRECTION.RIGHT) {\n      this.weapon.setPosition(40, 0);\n    }\n    if (this.playerAttacking) {\n      if (this.weapon.flipX) {\n        this.weapon.angle -= 10;\n      } else {\n        this.weapon.angle += 10;\n      }\n    } else {\n      if (this.currentDirection === DIRECTION.DOWN) {\n        this.weapon.setAngle(-270);\n      } else if (this.currentDirection === DIRECTION.UP) {\n        this.weapon.setAngle(-90);\n      } else {\n        this.weapon.setAngle(0);\n      }\n    }\n\n    this.weapon.flipX = false;\n    if (this.currentDirection === DIRECTION.LEFT) {\n      this.weapon.flipX = true;\n    }\n\n    this.updateHealthBar();\n  }\n\n  updateFlipX() {\n    this.player.flipX = this.flipX;\n  }\n\n  attack() {\n    this.attackAudio.play();\n    this.weapon.alpha = 1;\n    this.playerAttacking = true;\n    this.scene.time.delayedCall(\n      150,\n      () => {\n        this.weapon.alpha = 0;\n        this.playerAttacking = false;\n        this.swordHit = false;\n      },\n      [],\n      this\n    );\n  }\n}\n\nconst DIRECTION = {\n  RIGHT: \"RIGHT\",\n  LEFT: \"LEFT\",\n  UP: \"UP\",\n  DOWN: \"DOWN\",\n};\n\nexport default PlayerContainer;\n"]},"metadata":{},"sourceType":"module"}